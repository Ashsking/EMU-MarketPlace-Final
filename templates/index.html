{% extends "base.html" %}
{% block content %}

<!-- HERO SECTION -->
<div class="hero">
  <h1>Welcome to EMU Marketplace</h1>
  <p>Your one-stop platform for EMU merchandise and student-to-student buying & selling.</p>
  <div class="hero-buttons">
    <a href="{{ url_for('store') }}" class="contrast">Shop EMU Store</a>
    <a href="{{ url_for('marketplace') }}" class="secondary">Browse Student Marketplace</a>
  </div>
</div>

<!-- FEATURED STORE ITEMS -->
<section class="mt-2">
  <h2 class="text-center">Featured EMU Store Items</h2>

  {% if store_items|length == 0 %}
    <p class="text-center">No official merchandise available yet.</p>
  {% else %}
    <div class="product-grid mt-2">
      {% for item in store_items %}
      <article class="product-card">

        <!-- IMAGE -->
        {% if item.image %}
          {% if item.image.startswith("http") %}
            <img src="{{ item.image }}" alt="{{ item.itemName }}">
          {% else %}
            <img src="{{ url_for('static', filename=item.image) }}" alt="{{ item.itemName }}">
          {% endif %}
        {% else %}
          <img src="https://via.placeholder.com/400x250?text=EMU+Merch" alt="No Image">
        {% endif %}

        <!-- BODY -->
        <div class="product-card-body">
          <span class="badge badge-store">EMU Store</span>
          <span class="badge badge-{{ item.category }}">{{ item.category }}</span>

          <h3>{{ item.itemName }}</h3>

          <p class="price-tag">${{ "%.2f"|format(item.price) }}</p>

          <p class="product-description">{{ item.description }}</p>

          <a href="{{ url_for('buy_now', listing_id=item.id) }}" class="contrast">Buy Now</a>
        </div>

      </article>
      {% endfor %}
    </div>
  {% endif %}
</section>

<!-- FEATURED STUDENT ITEMS -->
<section class="mt-2">
  <h2 class="text-center">Latest Student Listings</h2>

  {% if student_items|length == 0 %}
    <p class="text-center">No student listings yet. <a href="{{ url_for('post') }}">Post your first item</a>!</p>
  {% else %}
    <div class="product-grid mt-2">
      {% for item in student_items %}
      <article class="product-card">

        <!-- IMAGE -->
        {% if item.image %}
          {% if item.image.startswith("http") %}
            <img src="{{ item.image }}" alt="{{ item.itemName }}">
          {% else %}
            <img src="{{ url_for('static', filename=item.image) }}" alt="{{ item.itemName }}">
          {% endif %}
        {% else %}
          <img src="https://via.placeholder.com/400x250?text=No+Image" alt="No Image">
        {% endif %}

        <!-- BODY -->
        <div class="product-card-body">
          <span class="badge badge-student">Student Listing</span>
          <span class="badge badge-{{ item.category }}">{{ item.category }}</span>
          <span class="badge badge-{{ item.condition }}">{{ item.condition }}</span>

          <h3>{{ item.itemName }}</h3>

          <p class="price-tag">${{ "%.2f"|format(item.price) }}</p>
          <p class="product-description">{{ item.description }}</p>

          {% if current_user %}
            {% if current_user.id != item.seller_id %}
              
              <a href="{{ url_for('buy_student', listing_id=item.id) }}" class="contrast">Buy Now</a>
            {% else %}
              <small><em>This is your listing</em></small>
            {% endif %}
          {% else %}
            <p><small><a href="{{ url_for('login') }}">Login to buy</a></small></p>
          {% endif %}
        </div>

      </article>
      {% endfor %}
    </div>
  {% endif %}
</section>

{% endblock %}
